7. Provide / Inject


Inicando un componente padre limpio

<script setup></script>

<template></template>

<style scoped></style>


el componente hijo de alerta

lo limpiamos

<script setup>

</script>

<template>
 
</template>


y le agregamos

<script setup>
    import { ref } from 'vue';
</script>


Definiremos unos componentes adicionales, definimos uncomponente llamado 

- Onecomponent.vue
- TwoComponen.vue
- ThreeComponent.vue

Copiamos la estrcutrua del componente padre enc ada componente hijo


Lo que quermeos es que en el cooonente app llamar al primer componente

<OneComponent></OneComponent>

Se importa el componente

import OneComponent from '@/components/OneComponent.vue'

en el componente hijo 1

tenemos

<script setup>
import TwoComponent from '@/components/TwoComponent.vue'
</script>

<template>
  <div class="bg-red-500 p-8">
    <p class="text-2xl">Hola desde el componente 1</p>
    <TwoComponent />
  </div>
</template>

<style scoped></style>


y en el componente 2

<template>
  <div class="bg-blue-500 p-8">
    <p class="text-2xl">Hola desde el componente 2</p>
  </div>
</template>



Tenemos un componente dentro de otro componente, finalmente llamamos al componente 3 desde el componente 3

<script setup>
import TwoComponent from '@/components/TwoComponent.vue'
</script>

<template>
  <div class="bg-yellow-500 p-8">
    <p class="text-2xl">Hola desde el componente 3</p>
  </div>
</template>

<style scoped></style>


Lo que queremos saber 


ahora dentro del componente uno quiero definir la propiedad del compoente 1,pueda seraccedido por el componente 3


Declaro una constante reactiva que inicialmente tiene una cadena vacia


<script setup>
import { ref } from 'vue'
import TwoComponent from '@/components/TwoComponent.vue'



//const nombre = ref('Klvst3r');
const nombre = ref('')
</script>

<template>
  <div class="bg-red-500 p-8">
    <p class="text-2xl">Hola desde el componente 1</p>
    <TwoComponent />
  </div>
</template>

<style scoped></style>



ahora para que el componente 3 tenga acceso a esta propiedad, debemos pasarle del componente 1 al componente 2, el valor y cuando lo reciba el componente 2 pasarlo al componente 3, podremos entonce hacer.


Indicamos que queremos pasar.

la propiedad se llama nombre y como la vamos a pasar dentro del mismo nombre hacemos

<TwoComponent :nombre/>

Ahora, una vez teniendo eso lo recibimos en el componente 2 dentro de los props, 

en el comopnente 2

definimos

<script setup>
import ThreeComponent from '@/components/ThreeComponent.vue'

const props = defineProps(['nombre']);


para recibir estenombre, desde este momento el componente 2 tiene acceso, a esta propiedad, lo que se tendria que hacer es pasarlo al componente 3.


 Le pasamos el nombre el cmponente 3

 <ThreeComponent :nombre/>

 y en el compoennte 3 hacemos lo mismo que en el componente 2

 const props = defineProps(['nombre']);

 De esta manera podria ahora si en el componente 3 mostrar esa inforamciÃ³n 

 en elc omponente 3



ahora en el componente 1 o desde el componente 1 definimos un valor.

const nombre = ref('Klvst3r');


Ese valor se parasara a traves de los componentes, lo que se define en el componente 1se imprime en el componente 3.



Si vemos para pasar un valor de un componente incial al final hemos tenido que pasar de componente a en componente, y el coopnente 2 no necesita es ainforamciÃ³n siplemente  lo esta recibiendo y volviendo a pasar, como es un valor no es tan complejo pero al escalarse el proyecto, con 6 nives o mas, empezamos a trabajar de esta manera.


Existe otra forma y es pasar un apropiedad del componente 1 al componente 3 sin estar definiendo props, entonces, es lo que se vera ahora.

Limpiando entonces los componentes

tenemos

Componente padre

<script setup>
import OneComponent from '@/components/OneComponent.vue'
</script>

<template>
  <OneComponent />
</template>

<style scoped></style>


primer componente
<script setup>
import { ref } from 'vue'
import TwoComponent from '@/components/TwoComponent.vue'



const nombre = ref('Klvst3r');
//const nombre = ref('')
</script>

<template>
  <div class="bg-red-500 p-8">
    <p class="text-2xl">Hola desde el componente 1</p>
    
    
    <TwoComponent :nombre/>
  </div>
</template>

<style scoped></style>



segundo componete
<script setup>
import ThreeComponent from '@/components/ThreeComponent.vue'

const props = defineProps(['nombre']);
</script>

<template>
  <div class="bg-blue-500 p-8">
    <p class="text-2xl">Hola desde el componente 2</p>
    <ThreeComponent :nombre/>
  </div>
</template>

<style scoped></style>



tercer componente
<script setup>
import TwoComponent from '@/components/TwoComponent.vue'
const props = defineProps(['nombre'])
</script>

<template>
  <div class="bg-yellow-500 p-8">
    <p class="text-2xl">Hola desde el componente 3</p>
    <p>{{ props.nombre }}</p>
  </div>
</template>

<style scoped></style>



En el componente 1 tenemos

<TwoComponent />

en el componente 2
quitamos

const props = defineProps(['nombre']);

por que ya no tenemos que recibir como un prop y eliminamos el pase del valor al tarcer componente quedando:



<ThreeComponent />

en el tercer componente quitamos 

const props = defineProps(['nombre'])

quedando

primer componente
<script setup>
import { ref } from 'vue'
import TwoComponent from '@/components/TwoComponent.vue'



const nombre = ref('Klvst3r');
//const nombre = ref('')
</script>

<template>
  <div class="bg-red-500 p-8">
    <p class="text-2xl">Hola desde el componente 1</p>
    
    
    <TwoComponent />
  </div>
</template>

<style scoped></style>


Segundo componente
<script setup>
import ThreeComponent from '@/components/ThreeComponent.vue'


</script>

<template>
  <div class="bg-blue-500 p-8">
    <p class="text-2xl">Hola desde el componente 2</p>
    <ThreeComponent />
  </div>
</template>

<style scoped></style>


tercer componente
<script setup></script>

<template>
  <div class="bg-yellow-500 p-8">
    <p class="text-2xl">Hola desde el componente 3</p>
    <!-- <p>{{ props.nombre }}</p> -->
  </div>
</template>

<style scoped></style>


Entonces como vamos a trabajar.

Vamos a dirigirnos al primer componente ya tenemos definida nuestra constante nombre, vamos a decir que la variable la queremos proporcionarla al componente hijo importando el siguiente metodo provide

<script setup>
import { ref, provide } from 'vue'

const nombre = ref('Klvst3r');
provide('nombre', nombre);

</script>

A este primer metodo tenemos que pasarle dos cosas, indicando como va a viajar la constante, queremos que viaje dentro de un compo llamado nombre

provide('nombre', nombre);



Como segundo parametro es pasarle el valor de nombre, la idea es ya no pasar por el componente 2


Ahora en el comonente que queiro recibirlo que nuestro caso es el componente 3, como lo recibimos, centrandonos en el script

importamos este metodo

import { inject } from 'vue'


Luego definimos una constante, con el nombre nombre y queremos recibir lo que se mando desde el componente 1

que es un campo llamado nombre 

const nombre = inject('nombre')

eso seria todo, pasamos una variable del componente padre al componente nieto.

PAra comprobarl

colocamos un aetieuta de imprsin con la valor de la constante

quedando entonces el componente 1
<script setup>
import { ref, provide } from 'vue'
import TwoComponent from '@/components/TwoComponent.vue'
const nombre = ref('Klvst3r')
provide('nombre', nombre)
</script>

<template>
  <div class="bg-red-500 p-8">
    <p class="text-2xl">Hola desde el componente 1</p>

    <TwoComponent />
  </div>
</template>

<style scoped></style>


y elc omponente 3 que recibe el valor

<script setup>
import { inject } from 'vue'

const nombre = inject('nombre')
</script>

<template>
  <div class="bg-yellow-500 p-8">
    <p class="text-2xl">Hola desde el componente 3</p>
    <p>
      {{ nombre }}
    </p>
  </div>
</template>

<style scoped></style>



Esta constante viaja dentro de un campo llamado nombre, con un parametro con el valor que va a biajar, como mencionamos, es que ya no vamos a pasar por el componente 2, y vamos a recbirlo de fente en el componente 3, mediante el script e importamos el metodo inject, luego definimos una constante le damos nombre y vamos a decirque que queremos recibir del componente 1 y lo recibimos.

Pasamos una variable de componente padre a componente nieto

Con esto tenemos el valor, de eta manera respeta, las variable reactivas.

si en el comopmnte 1 definimos un input, inicando el componente reactivo nombre


<input type="text" v-model="nombre">

Con esto lo que enviemos desde el componente 1 se envia hacia el componente 3

al momento de imprimir no devemos hacer

{{ nombre }}

por queesun ref no un string entonces debe ir la impresion

Queda entonces el componente 1

<script setup>
import { ref, provide } from 'vue'
import TwoComponent from '@/components/TwoComponent.vue'

const nombre = ref('Klvst3r')

provide('nombre', nombre)
</script>

<template>
  <div class="bg-red-500 p-8">
    <p class="text-2xl">Hola desde el componente 1</p>

    <input type="text" v-model="nombre" />

    <TwoComponent />
  </div>
</template>

<style scoped></style>


y recibe el componente 3

<script setup>
import { inject, watch, ref } from 'vue'

const nombre = inject('nombre') // <-- ref compartido
const mensaje = ref('') // <-- valor que mostrarÃ¡s

watch(nombre, (nuevoValor) => {
  mensaje.value = nuevoValor // <-- actualiza el mensaje visible
})
</script>

<template>
  <div class="bg-yellow-500 p-8">
    <p class="text-2xl">Hola desde el componente 3</p>

    <p>
      Nombre recibido por provide/inject:
      <strong>{{ nombre.value }}</strong>
    </p>

    <p class="mt-4">
      Valor detectado por watch:
      <strong>{{ mensaje }}</strong>
    </p>
  </div>
</template>



Cuando cambies el input en el componente 1:

âœ” nombre.value cambia
âœ” el watch recibe el valor nuevo
âœ” mensaje.value se actualiza
âœ” se imprime en tu etiqueta <p> de componente 3

SIN necesidad de consola.

ðŸ’¡ BONUS: Si solo quieres mostrar el valor y NO usar watch

Tu template puede ser simplemente:

{{ nombre.value }}


Y deberÃ­a mostrarse sin nada mÃ¡s.
El watch solo es Ãºtil si quieres ejecutar lÃ³gica adicional.